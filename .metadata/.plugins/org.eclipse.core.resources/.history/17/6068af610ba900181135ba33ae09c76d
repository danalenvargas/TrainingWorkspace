package com.ibm.cs.dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

import com.ibm.cs.entity.User;

public class LoginDAO extends MasterDAO{

	public LoginDAO() {
		// TODO Auto-generated constructor stub
	}
	
	public User getUser(String username, String password) {
		PreparedStatement pst = null;
		ResultSet rs = null;
		boolean hasResult;
		String userType;
		Connection conn = getConnection();
		
		try {
			pst = conn.prepareStatement("SELECT usertype FROM tbl_user WHERE name=? AND password=?");
			pst.setString(1, username);
			pst.setString(2, password);
			
			rs = pst.executeQuery();
			hasResult = rs.next();
			
			if(hasResult) {
				userType = rs.getString("usertype");
				return new User(username, password, userType);
			}
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} finally {
            if (rs != null) {
                try {
                    rs.close();
                } catch (SQLException e) {
                    e.printStackTrace();
                }
            }
            if (pst != null) {
                try {
                    pst.close();
                } catch (SQLException e) {
                    e.printStackTrace();
                }
            }
            if (conn != null) {
            	try {
                    conn.close();
                } catch (SQLException e) {
                    e.printStackTrace();
                }
            }
        }
		
		return null;
	}
	
}
