package com.ibm.training;

import java.text.ParseException;
import java.text.SimpleDateFormat;

public class Main {

	public static void main(String[] args) {
		Main prog = new Main();
		prog.execute();
	}
	
	public void execute() {
		Service productService = new Service();
		SimpleDateFormat dateFormat = new SimpleDateFormat("MM/dd/yyyy");
		try {
			Perishable veggies = new Perishable("veggies", dateFormat.parse("11/17/2018"));
			Perishable meats = new Perishable("meats", dateFormat.parse("09/02/2018"));
			Perishable milk = new Perishable("milk", dateFormat.parse("10/15/2018"));
			NonPerishable toys = new NonPerishable("toys", true);
			NonPerishable hammer = new NonPerishable("hammer", true);
			NonPerishable diaper = new NonPerishable("diaper", false);
			NonPerishable mugs = new NonPerishable("mugs", false);

			productService.addProduct(veggies);
			productService.addProduct(milk);
			productService.addProduct(toys);
			productService.addProduct(hammer);
			productService.addProduct(mugs);
			productService.addProduct(meats);
			productService.addProduct(diaper);

			System.out.println("Product at index " + 1 + " is:\n " + productService.getProduct(1));
			System.out.println("List of all products:\n" + arrayToString(productService.reviewProducts()));
			System.out.println("List of all Perishable products:\n" + arrayToString(productService.reviewProducts(EnumProdType.PERISHABLE)));
			System.out.println("List of all NonPerishable products:\n" + arrayToString(productService.reviewProducts(EnumProdType.NONPERISHABLE)));
			
			Thread checker = new Thread(new Checker(productService));
			checker.start();
		} catch (ParseException e) {
			System.out.println("Error in Parsing Date");
			e.printStackTrace();
		}
	}
	
	public String arrayToString(Product[] productArray) {
		StringBuffer listing = new StringBuffer("");
		for(int i=0; i<productArray.length; i++) {
			if(productArray[i] instanceof Product) {
				listing.append(productArray[i]);
			}
		}
		return listing.toString();
	}
}
