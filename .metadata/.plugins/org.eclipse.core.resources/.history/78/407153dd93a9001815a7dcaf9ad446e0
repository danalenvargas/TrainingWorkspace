package com.ibm.cs.dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import com.ibm.cs.entity.User;

public class UserManagementDAO extends MasterDAO {
	PreparedStatement pst = null;
	ResultSet rs = null;
	Connection conn = getConnection();

	public UserManagementDAO() {
		// TODO Auto-generated constructor stub
	}
	
	public ArrayList<User> getStandardUsers(){
		ArrayList<User> userList = new ArrayList<>();
		String username, password, userType;
		boolean canCreate, canRead, canUpdate, canDelete;
		
		try {
			pst = conn.prepareStatement("SELECT * FROM tbl_user "
					+ "INNER JOIN tbl_access_level ON tbl_user.user_id = tbl_access_level.fk_user_id "
					+ "WHERE usertype=?");
			pst.setString(1, "user");
			
			rs = pst.executeQuery();
			
			while (rs.next()) {
				username = rs.getString("username");
				password = rs.getString("password");
				userType = rs.getString("usertype");
				canCreate = rs.getBoolean("can_create");
				canRead = rs.getBoolean("can_read");
				canUpdate = rs.getBoolean("can_update");
				canDelete = rs.getBoolean("can_delete");
				
				userList.add(new User(username, password, userType, canCreate, canRead, canUpdate, canDelete));
            }
			
			return userList;
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} finally {
            if (rs != null) {
                try {rs.close();} catch (SQLException e) { e.printStackTrace();}
            }
            if (pst != null) {
                try {pst.close();} catch (SQLException e) {e.printStackTrace();}
            }
            if (conn != null) {
            	try {conn.close();} catch (SQLException e) {e.printStackTrace();}
            }
        }
		return null;
	}
	
	public void addUser(String username, String password, String userType, boolean canCreate, boolean canRead,
			boolean canUpdate, boolean canDelete) {
		
	}

}
